(this.webpackJsonptrain_ticket=this.webpackJsonptrain_ticket||[]).push([[9],{13:function(e,t,a){},15:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=(a(20),a(3)),c=a.n(i),o=a(4),l=a.n(o),s=(a(19),Object(n.memo)((function(e){var t=e.date,a=e.prev,i=e.next,o=e.isPrevDisabled,s=e.isNextDisabled,u=Object(n.useMemo)((function(){var e=l()(t);return e.format("M\u6708D\u65e5 ")+e.locale("zh-cn").format("ddd")}),[t]);return r.a.createElement("div",{className:"nav"},r.a.createElement("span",{className:c()("nav-prev",{"nav-disabled":o}),onClick:a},"\u524d\u4e00\u5929"),r.a.createElement("span",{className:"nav-current"},u),r.a.createElement("span",{className:c()("nav-next",{"nav-disabled":s}),onClick:i},"\u540e\u4e00\u5929"))})));t.a=s},16:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(0),r=a(2);function i(e,t,a,i){var c=Object(r.a)(e)<Object(r.a)(),o=Object(r.a)(e)-Object(r.a)()>1728e6,l=Object(n.useCallback)((function(){c||t(a())}),[t,c,a]),s=Object(n.useCallback)((function(){o||t(i())}),[t,o,i]);return{isPrevDisabled:c,isNextDisabled:o,prev:l,next:s}}},17:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=(a(22),a(4)),c=a.n(i);a(19);function o(e){var t=c()(e);return t.format("MM-DD")+""+t.locale("zh-cn").format("ddd")}var l=Object(n.memo)((function(e){var t=e.departDate,a=e.arriveDate,i=e.departTimeStr,c=e.arriveTimeStr,l=e.trainNumber,s=e.departStation,u=e.arriveStation,d=e.durationStr,m=Object(n.useMemo)((function(){return o(t)}),[t]),v=Object(n.useMemo)((function(){return o(a)}),[a]);return r.a.createElement("div",{className:"detail"},r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"left"},r.a.createElement("p",{className:"city"},s),r.a.createElement("p",{className:"time"},i),r.a.createElement("p",{className:"date"},m),r.a.createElement("p",null)),r.a.createElement("div",{className:"middle"},r.a.createElement("p",{className:"train-name"},l),r.a.createElement("p",{className:"train-mid"},e.children),r.a.createElement("p",{className:"train-time"},"\u8017\u65f6",d)),r.a.createElement("div",{className:"right"},r.a.createElement("p",{className:"city"},u),r.a.createElement("p",{className:"time"},c),r.a.createElement("p",{className:"date"},v))))}));t.a=l},2:function(e,t,a){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=new Date(e);return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.getTime()}a.d(t,"a",(function(){return n}))},20:function(e,t,a){},22:function(e,t,a){},57:function(e,t,a){e.exports=a(72)},58:function(e,t,a){},59:function(e,t,a){},60:function(e,t,a){},7:function(e,t,a){"use strict";a(13);var n=a(0),r=a.n(n);t.a=function(e){var t=e.onBack,a=e.title;return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"header-back",onClick:t},r.a.createElement("svg",{width:"42",height:"42"},r.a.createElement("polyline",{points:"25,13 16,21 25,29",stroke:"#fff",strokeWidth:"2",fill:"none"}))),r.a.createElement("h1",{className:"header-title"},a))}},72:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(10),c=a.n(i),o=a(6),l=(a(18),a(1)),s=a(2),u="SET_DEPART_DATE",d="SET_ARRIVE_DATE",m="SET_DEPART_TIME_STR",v="SET_ARRIVE_TIME_STR",p="SET_DEPART_STATION",f="SET_ARRIVE_STATION",h="SET_TRAIN_NUMBER",E="SET_DURATION_STR",b="SET_TICKETS",S="SET_IS_SCHEDULE_VISIBLE",y="SET_SEARCH_PARSED";function g(e){return{type:u,payload:e}}function N(){return function(e,t){e(function(e){return{type:S,payload:e}}(!t().isScheduleVisible))}}function w(){return function(e,t){var a=t().departDate;e(g(Object(s.a)(a)+864e5))}}function T(){return function(e,t){var a=t().departDate;e(g(Object(s.a)(a)-864e5))}}var D={departDate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case u:return n}return e},arriveDate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case d:return n}return e},departTimeStr:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case m:return n}return e},arriveTimeStr:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case v:return n}return e},departStation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case p:return n}return e},arriveStation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case f:return n}return e},trainNumber:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case h:return n}return e},durationStr:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case E:return n}return e},tickets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case b:return n}return e},isScheduleVisible:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case S:return n}return e},searchParsed:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case y:return n}return e}},O=a(12),j=Object(l.d)(Object(l.c)(D),{departDate:Date.now(),arriveDate:Date.now(),departTimeStr:null,arriveTimeStr:null,departStation:null,arriveStation:null,trainNumber:null,durationStr:null,tickets:[],isScheduleVisible:!1,searchParsed:!1},Object(l.a)(O.a)),k=(a(58),a(59),a(8)),_=a.n(k),R=a(7),A=a(15),x=a(17),C=a(5),M=a(4),I=a.n(M),P=(a(60),Object(n.createContext)()),V=Object(n.memo)((function(e){var t=e.name,a=e.desc,i=e.type,c=Object(n.useContext)(P),o=c.trainNumber,l=c.departStation,s=c.arriveStation,u=c.departDate,d=Object(n.useMemo)((function(){return new _.a("order.html").setSearch("trainNumber",o).setSearch("dStation",l).setSearch("aStation",s).setSearch("type",i).setSearch("date",I()(u).format("YYYY-MM-DD")).toString()}),[o,l,s,u,i]);return r.a.createElement("div",{className:"channel"},r.a.createElement("div",{className:"middle"},r.a.createElement("div",{className:"name"},t),r.a.createElement("div",{className:"desc"},a)),r.a.createElement("a",{href:d,className:"buy-wrapper"},r.a.createElement("div",{className:"buy"},"\u4e70\u7968")))})),W=Object(n.memo)((function(e){var t=e.type,a=e.priceMsg,n=e.ticketsLeft,i=e.channels,c=e.expanded,o=e.onToggle,l=e.idx;return r.a.createElement("li",null,r.a.createElement("div",{className:"bar",onClick:function(){return o(l)}},r.a.createElement("span",{className:"seat"},t),r.a.createElement("span",{className:"price"},r.a.createElement("i",null,"\uffe5"),a),r.a.createElement("span",{className:"btn"},c?"\u6536\u8d77":"\u9884\u5b9a"),r.a.createElement("span",{className:"num"},n)),r.a.createElement("div",{className:"channels",style:{height:c?55*i.length+"px":0}},i.map((function(e){return r.a.createElement(V,Object.assign({key:e.name},e,{type:t}))}))))})),Y=Object(n.memo)((function(e){var t=Object(n.useState)(-1),a=Object(C.a)(t,2),i=a[0],c=a[1],o=e.tickets,l=Object(n.useCallback)((function(e){c(e===i?-1:e)}),[i]);return r.a.createElement("div",{className:"candidate"},r.a.createElement("ul",null,o.map((function(e,t){return r.a.createElement(W,Object.assign({},e,{key:e.type,expanded:i===t,onToggle:l,idx:t}))}))))})),B=a(16),U=Object(n.lazy)((function(){return a.e(10).then(a.bind(null,74))}));var L=Object(o.b)((function(e){return e}),(function(e){return{dispatch:e}}))((function(e){var t=e.departDate,a=e.arriveDate,i=e.departTimeStr,c=e.arriveTimeStr,o=e.departStation,u=e.arriveStation,S=e.trainNumber,D=e.durationStr,O=e.tickets,j=e.isScheduleVisible,k=e.searchParsed,C=e.dispatch,M=Object(n.useCallback)((function(){window.history.back()}),[]);Object(n.useEffect)((function(){var e=_.a.parseQuery(window.location.search),t=e.aStation,a=e.dStation,n=e.date,r=e.trainNumber;C(function(e){return{type:p,payload:e}}(a)),C(function(e){return{type:f,payload:e}}(t)),C(function(e){return{type:h,payload:e}}(r)),C(g(Object(s.a)(I()(n).valueOf()))),C(function(e){return{type:y,payload:e}}(!0))}),[C]),Object(n.useEffect)((function(){document.title=S}),[S]),Object(n.useEffect)((function(){if(k){var e=new _.a("/rest/ticket").setSearch("data",I()(t).format("YYYY-MM-DD")).setSearch("trainNumber",S).toString();fetch(e).then((function(e){return e.json()})).then((function(e){var t=e.detail,a=e.candidates,n=t.departTimeStr,r=t.arriveTimeStr,i=t.arriveDate,c=t.durationStr;C(function(e){return{type:m,payload:e}}(n)),C(function(e){return{type:v,payload:e}}(r)),C(function(e){return{type:d,payload:e}}(i)),C(function(e){return{type:E,payload:e}}(c)),C(function(e){return{type:b,payload:e}}(a))}))}}),[k,t,S,C]);var V=Object(B.a)(t,C,T,w),W=V.isPrevDisabled,L=V.isNextDisabled,z=V.prev,H=V.next,J=Object(n.useMemo)((function(){return Object(l.b)({toggleIsScheduleVisible:N},C)}),[C]);return k?r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"header-wrapper"},r.a.createElement(R.a,{title:S,onBack:M})),r.a.createElement("div",{className:"nav-wrapper"},r.a.createElement(A.a,{date:t,isPrevDisabled:W,isNextDisabled:L,prev:z,next:H})),r.a.createElement("div",{className:"detail-wrapper"},r.a.createElement(x.a,{departDate:t,arriveDate:a,departTimeStr:i,arriveTimeStr:c,trainNumber:S,departStation:o,arriveStation:u,durationStr:D},r.a.createElement("span",{className:"left"}),r.a.createElement("span",{className:"schedule",onClick:function(){return J.toggleIsScheduleVisible()}},"\u65f6\u523b\u8868"),r.a.createElement("span",{className:"right"}))),r.a.createElement(P.Provider,{value:{trainNumber:S,departStation:o,arriveStation:u,departDate:t}},r.a.createElement(Y,{tickets:O})),j&&r.a.createElement("div",{className:"mask",onClick:function(){return C(N())}},r.a.createElement(n.Suspense,{fallback:r.a.createElement("div",null,"loading")},r.a.createElement(U,{date:t,trainNumber:S,departStation:o,arriveStation:u})))):null})),z=a(9);c.a.render(r.a.createElement(o.a,{store:j},r.a.createElement(L,null)),document.getElementById("root")),z.a()},9:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function r(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");n?(!function(e,t){fetch(e).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):i(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):i(t,e)}))}}function i(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}}},[[57,8,0,1]]]);
//# sourceMappingURL=ticket.ea3de19b.chunk.js.map