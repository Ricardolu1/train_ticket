(this.webpackJsonptrain_ticket=this.webpackJsonptrain_ticket||[]).push([[3],{13:function(e,t,n){},17:function(e,t,n){"use strict";var a=n(0),r=n.n(a),l=(n(22),n(4)),i=n.n(l);n(19);function c(e){var t=i()(e);return t.format("MM-DD")+""+t.locale("zh-cn").format("ddd")}var o=Object(a.memo)((function(e){var t=e.departDate,n=e.arriveDate,l=e.departTimeStr,i=e.arriveTimeStr,o=e.trainNumber,u=e.departStation,s=e.arriveStation,d=e.durationStr,m=Object(a.useMemo)((function(){return c(t)}),[t]),p=Object(a.useMemo)((function(){return c(n)}),[n]);return r.a.createElement("div",{className:"detail"},r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"left"},r.a.createElement("p",{className:"city"},u),r.a.createElement("p",{className:"time"},l),r.a.createElement("p",{className:"date"},m),r.a.createElement("p",null)),r.a.createElement("div",{className:"middle"},r.a.createElement("p",{className:"train-name"},o),r.a.createElement("p",{className:"train-mid"},e.children),r.a.createElement("p",{className:"train-time"},"\u8017\u65f6",d)),r.a.createElement("div",{className:"right"},r.a.createElement("p",{className:"city"},s),r.a.createElement("p",{className:"time"},i),r.a.createElement("p",{className:"date"},p))))}));t.a=o},22:function(e,t,n){},61:function(e,t,n){e.exports=n(69)},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(10),i=n.n(l),c=n(6),o=(n(18),n(1));function u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var s="SET_TRAIN_NUMBER",d="SET_DEPART_STATION",m="SET_ARRIVE_STATION",p="SET_SEAT_TYPE",f="SET_DEPART_DATE",v="SET_ARRIVE_DATE",h="SET_DEPART_TIME_STR",y="SET_ARRIVE_TIME_STR",E="SET_DURATION_STR",g="SET_PRICE",b="SET_PASSENGERS",N="SET_MENU",w="SET_IS_MENU_VISIBLE",S="SET_SEARCH_PARSED";function T(e){return{type:b,payload:e}}function k(e){return{type:w,payload:e}}function A(e){return function(t,n){fetch(e).then((function(e){return e.json()})).then((function(e){var n=e.departTimeStr,a=e.arriveTimeStr,r=e.arriveDate,l=e.durationStr,i=e.price;t(function(e){return{type:h,payload:e}}(n)),t(function(e){return{type:y,payload:e}}(a)),t(function(e){return{type:v,payload:e}}(r)),t(function(e){return{type:E,payload:e}}(l)),t(function(e){return{type:g,payload:e}}(i))}))}}var O=0;function j(){return function(e,t){var n=t().passengers,a=!0,r=!1,l=void 0;try{for(var i,c=n[Symbol.iterator]();!(a=(i=c.next()).done);a=!0)for(var o=i.value,s=Object.keys(o),d=0,m=s;d<m.length;d++){if(!o[m[d]])return}}catch(p){r=!0,l=p}finally{try{a||null==c.return||c.return()}finally{if(r)throw l}}e(T([].concat(u(n),[{id:++O,name:"",ticketType:"adult",licenceNo:"",seat:"Z"}])))}}function M(){return function(e,t){var n=t().passengers,a=null,r=!0,l=!1,i=void 0;try{for(var c,o=n[Symbol.iterator]();!(r=(c=o.next()).done);r=!0){for(var s=c.value,d=Object.keys(s),m=0,p=d;m<p.length;m++){if(!s[p[m]])return}"adult"===s.ticketType&&(a=s.id)}}catch(f){l=!0,i=f}finally{try{r||null==o.return||o.return()}finally{if(l)throw i}}a?e(T([].concat(u(n),[{id:++O,name:"",gender:"none",birthday:"",followAdult:a,ticketType:"child",seat:"Z"}]))):alert("\u8bf7\u81f3\u5c11\u6b63\u786e\u6dfb\u52a0\u4e00\u4e2a\u540c\u884c\u6210\u4eba")}}function _(e){return function(t,n){t(T(n().passengers.filter((function(t){return t.id!==e&&t.followAdult!==e}))))}}function D(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return function(a,r){for(var l=r().passengers,i=0;i<l.length;++i)if(l[i].id===e){var c=u(l);c[i]=Object.assign({},l[i],t);var o=!0,s=!1,d=void 0;try{for(var m,p=n[Symbol.iterator]();!(o=(m=p.next()).done);o=!0){var f=m.value;delete c[i][f]}}catch(v){s=!0,d=v}finally{try{o||null==p.return||p.return()}finally{if(s)throw d}}a(T(c));break}}}function C(e){return function(t){t(function(e){return{type:N,payload:e}}(e)),t(k(!0))}}function P(){return k(!1)}function R(e){return function(t,n){var a=n().passengers.find((function(t){return t.id===e}));a&&t(C({onPress:function(n){t(D(e,{gender:n})),t(P())},options:[{title:"\u7537",value:"male",active:"male"===a.gender},{title:"\u5973",value:"female",active:"female"===a.gender}]}))}}function I(e){return function(t,n){var a=n().passengers,r=a.find((function(t){return t.id===e}));r&&t(C({onPress:function(n){t(D(e,{followAdult:n})),t(P())},options:a.filter((function(e){return"adult"===e.ticketType})).map((function(e){return{title:e.name,value:e.id,active:e.id===r.followAdult}}))}))}}function x(e){return function(t,n){var a=n().passengers,r=a.find((function(t){return t.id===e}));r&&t(C({onPress:function(n){if("adult"===n)t(D(e,{ticketType:n,licenceNo:""},["gender","followAdult","birthday"]));else{var r=a.find((function(t){return t.id!==e&&"adult"===t.ticketType}));r?t(D(e,{ticketType:n,gender:"",followAdult:r.id,birthday:""},["licenceNo"])):alert("\u6ca1\u6709\u5176\u4ed6\u6210\u4eba\u4e58\u5ba2")}t(P())},options:[{title:"\u6210\u4eba\u7968",value:"adult",active:"adult"===r.ticketType},{title:"\u513f\u7ae5\u7968",value:"child",active:"child"===r.ticketType}]}))}}var U={trainNumber:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case s:return a}return e},departStation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case d:return a}return e},arriveStation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case m:return a}return e},seatType:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case p:return a}return e},departDate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case f:return a}return e},arriveDate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case v:return a}return e},departTimeStr:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case h:return a}return e},arriveTimeStr:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case y:return a}return e},durationStr:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case E:return a}return e},price:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case g:return a}return e},passengers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case b:return a}return e},menu:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case N:return a}return e},isMenuVisible:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case w:return a}return e},searchParsed:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case S:return a}return e}},W=n(12),B=Object(o.d)(Object(o.c)(U),{trainNumber:null,departStation:null,arriveStation:null,seatType:null,departDate:Date.now(),arriveDate:Date.now(),departTimeStr:null,arriveTimeStr:null,durationStr:null,price:null,passengers:[],menu:null,isMenuVisible:!1,searchParsed:!1},Object(o.a)(W.a)),V=(n(62),n(8)),F=n.n(V),G=(n(63),n(7)),Y=n(17),L=n(5),J=(n(64),n(3)),Z=n.n(J),z=Object(a.memo)((function(e){var t=e.price,n=void 0===t?0:t,l=e.length,i=Object(a.useState)(!1),c=Object(L.a)(i,2),o=c[0],u=c[1];return r.a.createElement("div",{className:"account"},r.a.createElement("div",{className:Z()("price",{expanded:o}),onClick:function(){return u(!o)}},r.a.createElement("div",{className:"money"},l*n),r.a.createElement("div",{className:"amount"},"\u652f\u4ed8\u91d1\u989d")),r.a.createElement("div",{className:"button"},"\u63d0\u4ea4\u6309\u94ae"),r.a.createElement("div",{className:Z()("layer",{hidden:!o}),onClick:function(){return u(!1)}}),r.a.createElement("div",{className:Z()("detail",{hidden:!o})},r.a.createElement("div",{className:"title"},"\u91d1\u989d\u8be6\u60c5"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("span",null,"\u706b\u8f66\u7968"),r.a.createElement("span",null,"\uffe5",n),r.a.createElement("span",null,"\xd7",l)))))})),H=(n(65),Object(a.memo)((function(e){var t=e.passengers,n=e.updatePassenger;function a(e){return r.a.createElement("div",null,t.map((function(t){return r.a.createElement("p",{key:t.id,className:Z()("seat",{active:t.seat===e}),"data-text":e,onClick:function(){return n(t.id,{seat:e})}},"\ue02d")})))}return r.a.createElement("div",{className:"choose"},r.a.createElement("p",{className:"tip"},"\u5728\u7ebf\u9009\u5ea7"),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"seats"},r.a.createElement("div",null,"\u7a97"),a("A"),a("B"),a("C"),r.a.createElement("div",null,"\u8fc7\u9053"),a("D"),a("F"),r.a.createElement("div",null,"\u7a97"))))}))),Q=(n(66),Object(a.memo)((function(e){var t=e.id,n=e.name,a=e.ticketType,l=e.licenceNo,i=e.gender,c=e.birthday,o=e.onRemove,u=e.onUpdate,s=e.showGenderMenu,d=e.showFollowAdultMenu,m=e.showTicketTypeMenu,p=e.followAdultName,f="adult"===a;return r.a.createElement("li",{className:"passenger"},r.a.createElement("i",{className:"delete",onClick:function(){return o(t)}},"-"),r.a.createElement("ol",{className:"items"},r.a.createElement("li",{className:"item"},r.a.createElement("label",{className:"label name"},"\u59d3\u540d"),r.a.createElement("input",{type:"text",className:"input name",placeholder:"\u4e58\u5ba2\u59d3\u540d",value:n,onChange:function(e){return u(t,{name:e.target.value})}}),r.a.createElement("label",{className:"ticket-type",onClick:function(){return m(t)}},f?"\u6210\u4eba\u7968":"\u513f\u7ae5\u7968")),f&&r.a.createElement("li",{className:"item"},r.a.createElement("label",{className:"label licenceNo"},"\u8eab\u4efd\u8bc1"),r.a.createElement("input",{type:"text",className:"input licenceNo",placeholder:"\u8bc1\u4ef6\u53f7\u7801",value:l,onChange:function(e){return u(t,{licenceNo:e.target.value})}})),!f&&r.a.createElement("li",{className:"item arrow"},r.a.createElement("label",{className:"label gender"},"\u6027\u522b"),r.a.createElement("input",{type:"text",className:"input gender",placeholder:"\u8bf7\u9009\u62e9",onClick:function(){return s(t)},value:"male"===i?"\u7537":"female"===i?"\u5973":"",readOnly:!0})),!f&&r.a.createElement("li",{className:"item"},r.a.createElement("label",{className:"label birthday"},"\u51fa\u751f\u65e5\u671f"),r.a.createElement("input",{type:"text",className:"input birthday",placeholder:"\u598219951015",value:c,onChange:function(e){return u(t,{birthday:e.target.value})}})),!f&&r.a.createElement("li",{className:"item arrow"},r.a.createElement("label",{className:"label followAdult"},"\u540c\u884c\u6210\u4eba"),r.a.createElement("input",{type:"text",className:"input followAdult",placeholder:"\u8bf7\u9009\u62e9",value:p,onClick:function(){return d(t)},readOnly:!0}))))}))),$=Object(a.memo)((function(e){var t=e.passengers,n=e.createAdult,l=e.createChild,i=e.removePassenger,c=e.updatePassenger,o=e.showGenderMenu,u=e.showFollowAdultMenu,s=e.showTicketTypeMenu,d=Object(a.useMemo)((function(){var e={},n=!0,a=!1,r=void 0;try{for(var l,i=t[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var c=l.value;e[c.id]=c.name}}catch(o){a=!0,r=o}finally{try{n||null==i.return||i.return()}finally{if(a)throw r}}return e}),[t]);return r.a.createElement("div",{className:"passengers"},r.a.createElement("ul",null,t.map((function(e){return r.a.createElement(Q,Object.assign({followAdultName:d[e.followAdult]},e,{key:e.id,onRemove:i,onUpdate:c,showGenderMenu:o,showFollowAdultMenu:u,showTicketTypeMenu:s}))}))),r.a.createElement("section",{className:"add"},r.a.createElement("div",{className:"adult",onClick:function(){return n()}},"\u6dfb\u52a0\u6210\u4eba"),r.a.createElement("div",{className:"child",onClick:function(){return l()}},"\u6dfb\u52a0\u513f\u7ae5")))})),q=(n(67),Object(a.memo)((function(e){var t=e.price,n=e.type;return r.a.createElement("div",{className:"ticket"},r.a.createElement("p",null,r.a.createElement("span",{className:"ticket-type"},n),r.a.createElement("span",{className:"ticket-price"},t)),r.a.createElement("div",{className:"label"},"\u5750\u5e2d"))}))),K=(n(68),Object(a.memo)((function(e){var t=e.onPress,n=e.title,a=e.value,l=e.active;return r.a.createElement("li",{className:Z()({active:l}),onClick:function(){return t(a)}},n)}))),X=Object(a.memo)((function(e){var t=e.show,n=e.options,a=e.onPress,l=e.hideMenu;return r.a.createElement("div",null,t&&r.a.createElement("div",{className:"menu-mask",onClick:function(){return l()}}),r.a.createElement("div",{className:Z()("menu",{show:t})},r.a.createElement("div",{className:"menu-title"}),r.a.createElement("ul",null,n&&n.map((function(e){return r.a.createElement(K,Object.assign({key:e.value},e,{onPress:a}))})))))})),ee=n(4),te=n.n(ee);var ne=Object(c.b)((function(e){return e}),(function(e){return{dispatch:e}}))((function(e){var t=e.trainNumber,n=e.departStation,l=e.arriveStation,i=e.seatType,c=e.departDate,u=e.arriveDate,v=e.departTimeStr,h=e.arriveTimeStr,y=e.durationStr,E=e.price,g=e.passengers,b=e.menu,N=e.isMenuVisible,w=e.searchParsed,T=e.dispatch,k=Object(a.useCallback)((function(){window.history.back()}),[]);Object(a.useEffect)((function(){var e=F.a.parseQuery(window.location.search),t=e.trainNumber,n=e.dStation,a=e.aStation,r=e.type,l=e.date;T(function(e){return{type:d,payload:e}}(n)),T(function(e){return{type:m,payload:e}}(a)),T(function(e){return{type:s,payload:e}}(t)),T(function(e){return{type:p,payload:e}}(r)),T(function(e){return{type:f,payload:e}}(te()(l).valueOf())),T(function(e){return{type:S,payload:e}}(!0))}),[T]),Object(a.useEffect)((function(){if(w){var e=new F.a("/rest/order").setSearch("dStation",n).setSearch("aStation",l).setSearch("type",i).setSearch("date",te()(c).format("YYYY-MM-DD")).toString();T(A(e))}}),[w,n,l,i,c,T]);var O=Object(a.useMemo)((function(){return Object(o.b)({createAdult:j,createChild:M,removePassenger:_,updatePassenger:D,showGenderMenu:R,showFollowAdultMenu:I,showTicketTypeMenu:x},T)}),[T]),C=Object(a.useMemo)((function(){return Object(o.b)({hideMenu:P},T)}),[T]),U=Object(a.useMemo)((function(){return Object(o.b)({updatePassenger:D},T)}),[T]);return w?r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"header-wrapper"},r.a.createElement(G.a,{title:"\u8ba2\u5355\u586b\u5199",onBack:k})),r.a.createElement("div",{className:"detail-wrapper"},r.a.createElement(Y.a,{departDate:c,arriveDate:u,departTimeStr:v,arriveTimeStr:h,trainNumber:t,departStation:n,arriveStation:l,durationStr:y},r.a.createElement("span",{className:"train-icon",style:{display:"block"}})),r.a.createElement(q,{price:E,type:i}),r.a.createElement($,Object.assign({passengers:g},O)),g.length>0&&r.a.createElement(H,Object.assign({passengers:g},U)),r.a.createElement(z,{length:g.length,price:E}),r.a.createElement(X,Object.assign({show:N},b,C)))):null})),ae=n(9);i.a.render(r.a.createElement(c.a,{store:B},r.a.createElement(ne,null)),document.getElementById("root")),ae.a()},7:function(e,t,n){"use strict";n(13);var a=n(0),r=n.n(a);t.a=function(e){var t=e.onBack,n=e.title;return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"header-back",onClick:t},r.a.createElement("svg",{width:"42",height:"42"},r.a.createElement("polyline",{points:"25,13 16,21 25,29",stroke:"#fff",strokeWidth:"2",fill:"none"}))),r.a.createElement("h1",{className:"header-title"},n))}},9:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function r(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");a?(!function(e,t){fetch(e).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):l(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):l(t,e)}))}}function l(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}}},[[61,6,0,1]]]);
//# sourceMappingURL=order.723d9392.chunk.js.map