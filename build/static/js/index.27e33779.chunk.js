(this.webpackJsonptrain_ticket=this.webpackJsonptrain_ticket||[]).push([[2],{13:function(e,t,n){},2:function(e,t,n){"use strict";function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=new Date(e);return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.getTime()}n.d(t,"a",(function(){return a}))},32:function(e,t,n){e.exports=n.p+"static/media/switch.e6009882.svg"},33:function(e,t,n){e.exports=n(70)},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},7:function(e,t,n){"use strict";n(13);var a=n(0),c=n.n(a);t.a=function(e){var t=e.onBack,n=e.title;return c.a.createElement("div",{className:"header"},c.a.createElement("div",{className:"header-back",onClick:t},c.a.createElement("svg",{width:"42",height:"42"},c.a.createElement("polyline",{points:"25,13 16,21 25,29",stroke:"#fff",strokeWidth:"2",fill:"none"}))),c.a.createElement("h1",{className:"header-title"},n))}},70:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(10),i=n.n(r),o=n(6),l=(n(18),n(1)),s="SET_FROM",u="SET_TO",m="SET_IS_CITY_SELECTOR_VISIBLE",d="SET_CURRENT_SELECTING_LEFT_CITY",h="SET_CITY_DATA",f="SET_IS_LOADING_CITY_DATA",y="SET_IS_DATE_SELECTOR_VISIBLE",p="SET_HIGH_SPEED",v="SET_DEPART_DATE";function g(e){return{type:s,payload:e}}function E(e){return{type:u,payload:e}}function b(e){return{type:f,payload:e}}function w(e){return{type:h,payload:e}}function S(){return function(e,t){var n=t().highSpeed;e({type:p,payload:!n})}}function k(e){return function(t){t({type:m,payload:!0}),t({type:d,payload:e})}}function j(){return{type:m,payload:!1}}function N(e){return function(t,n){t(n().currentSelectingLeftCity?g(e):E(e)),t(j())}}function O(){return{type:y,payload:!0}}function C(){return{type:y,payload:!1}}function D(){return function(e,t){var n=t(),a=n.from;e(g(n.to)),e(E(a))}}function T(){return function(e,t){if(!t().isLoadingCityData){var n=JSON.parse(localStorage.getItem("city_data_cache")||"{}");Date.now()<n.expires?e(w(n.data)):(e(b(!0)),fetch("/rest/cities?_"+Date.now()).then((function(e){return e.json()})).then((function(t){e(w(t)),localStorage.setItem("city_data_cache",JSON.stringify({expires:Date.now()+6e4,data:t})),e(b(!1))})).catch((function(){e(b(!1))})))}}}var _={from:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u5317\u4eac",t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case s:return a}return e},to:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u4e0a\u6d77",t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case u:return a}return e},isCitySelectorVisible:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case m:return a}return e},currentSelectingLeftCity:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case d:return a}return e},cityData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case h:return a}return e},isLoadingCityData:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case f:return a}return e},isDateSelectorVisible:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case y:return a}return e},highSpeed:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case p:return a}return e},departDate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case v:return a}return e}},M=n(12),I=Object(l.d)(Object(l.c)(_),{from:"\u5317\u4eac",to:"\u5357\u4eac",isCitySelectorVisible:!1,currentSelectingLeftCity:!1,cityData:null,isLoadingCityData:!1,isDateSelectorVisible:!1,highSpeed:!1,departDate:Date.now()},Object(l.a)(M.a)),A=(n(42),n(43),n(7)),L=(n(44),n(2)),x=n(4),B=n.n(x);var R=function(e){var t=e.time,n=e.onClick,r=Object(L.a)(t),i=new Date(r),o=Object(a.useMemo)((function(){return B()(r).format("YYYY-MM-DD")}),[r]),l=r===Object(L.a)(),s="\u5468"+["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"][i.getDay()]+(l?"(\u4eca\u5929)":"");return c.a.createElement("div",{className:"depart-date",onClick:n},c.a.createElement("input",{type:"hidden",name:"date",value:o}),o," ",c.a.createElement("span",{className:"depart-week"}," ",s))},V=(n(45),n(3)),W=n.n(V);var Y=function(e){var t=e.highSpeed,n=e.toggle;return c.a.createElement("div",{className:"high-speed"},c.a.createElement("div",{className:"high-speed-label"},"\u53ea\u770b\u9ad8\u94c1\u52a8\u8f66"),c.a.createElement("div",{className:"high-speed-switch",onClick:function(){return n()}},c.a.createElement("input",{type:"hidden",name:"highSpeed",value:t}),c.a.createElement("div",{className:W()("high-speed-track",{checked:t})},c.a.createElement("span",{className:W()("high-speed-handle",{checked:t})}))))},F=(n(46),n(32)),U=n.n(F);var H=function(e){var t=e.from,n=e.to,a=e.exchangeFromTo,r=e.showCitySelector;return c.a.createElement("div",{className:"journey"},c.a.createElement("div",{className:"journey-station",onClick:function(){return r(!0)}},c.a.createElement("input",{type:"text",readOnly:!0,name:"from",value:t,className:"journey-input journey-from"})),c.a.createElement("div",{className:"journey-switch",onClick:function(){return a()}},c.a.createElement("img",{src:U.a,width:"70",height:"40",alt:"switch"})),c.a.createElement("div",{className:"journey-station",onClick:function(){return r(!1)}},c.a.createElement("input",{type:"text",readOnly:!0,name:"to",value:n,className:"journey-input journey-to"})))},J=(n(47),Object(a.memo)((function(){return c.a.createElement("div",{className:"submit"},c.a.createElement("button",{className:"submit-button",type:"submit"},"\u641c\u7d22"))}))),P=n(5),G=(n(48),Object(a.memo)((function(e){var t=e.name,n=e.onSelect;return c.a.createElement("li",{className:"city-li",onClick:function(){return n(t)}},t)}))),K=Object(a.memo)((function(e){var t=e.title,n=e.cities,a=void 0===n?[]:n,r=e.onSelect;return c.a.createElement("ul",{className:"city-ul","data-cate":t},c.a.createElement("li",{className:"city-li"},t),a.map((function(e){return c.a.createElement(G,{key:e.name,name:e.name,onSelect:r})})))})),q=Object(a.memo)((function(e){var t=e.alpha,n=e.onClick;return c.a.createElement("li",{className:"city-index-item",onClick:function(){return n(t)}},t)})),$=Array.from(new Array(26),(function(e,t){return String.fromCharCode(65+t)})),z=Object(a.memo)((function(e){var t=e.sections,n=e.onSelect,a=e.toAlpha;return console.dir(t),c.a.createElement("div",{className:"city-list"},c.a.createElement("div",{className:"city-cate"},t.map((function(e){return c.a.createElement(K,{key:e.title,title:e.title,cities:e.citys,onSelect:n})}))),c.a.createElement("div",{className:"city-index"},$.map((function(e){return c.a.createElement(q,{key:e,alpha:e,onClick:a})}))))})),Q=Object(a.memo)((function(e){var t=e.name,n=e.onClick;return c.a.createElement("li",{className:"city-suggest-li",onClick:function(){return n(t)}},t)})),X=Object(a.memo)((function(e){var t=e.searchKey,n=e.onSelect,r=Object(a.useState)([]),i=Object(P.a)(r,2),o=i[0],l=i[1];Object(a.useEffect)((function(){fetch("/rest/search?key="+encodeURIComponent(t)).then((function(e){return e.json})).then((function(e){var n=e.result;e.searchKey===t&&l(n)}))}),[t]);var s=Object(a.useMemo)((function(){return o.length?o:[{display:t}]}),[o,t]);return c.a.createElement("li",{className:"city-suggest"},c.a.createElement("ul",{className:"city-suggest-ul"},s.map((function(e){return c.a.createElement(Q,{key:e.display,name:e.display,onClick:n})}))))})),Z=Object(a.memo)((function(e){var t=e.show,n=e.cityData,r=e.isLoading,i=e.onBack,o=e.fetchCityData,l=e.onSelect,s=Object(a.useState)(""),u=Object(P.a)(s,2),m=u[0],d=u[1],h=Object(a.useMemo)((function(){return m.trim()}),[m]);Object(a.useEffect)((function(){!t||n||r||o()}),[t,n,r,o]);var f=Object(a.useCallback)((function(e){document.querySelector("[data-cate=".concat(e,"]")).scrollIntoView(!0)}),[]);return c.a.createElement("div",{className:W()("city-selector",{hidden:!t})},c.a.createElement("div",{className:"city-search"},c.a.createElement("div",{className:"search-back",onClick:function(){return i()}},c.a.createElement("svg",{width:"42",height:"42"},c.a.createElement("polyline",{points:"25,13 16,21 25,29",stroke:"#fff",strokeWidth:"2",fill:"none"}))),c.a.createElement("div",{className:"search-input-wrapper"},c.a.createElement("input",{type:"text",value:m,className:"search-input",placeholder:"\u57ce\u5e02\u3001\u8f66\u7ad9\u7684\u4e2d\u6587\u6216\u62fc\u97f3",onChange:function(e){return d(e.target.value)}})),c.a.createElement("i",{className:W()("search-clean",{hidden:0===h.length}),onClick:function(){return d("")}},"\uf063")),Boolean(h)&&c.a.createElement(X,{searchKey:h,onSelect:function(e){return l(e)}}),r?c.a.createElement("div",null,"loading"):n?c.a.createElement(z,{sections:n.cityList,onSelect:l,toAlpha:f}):c.a.createElement("div",null,"error"))}));n(49);function ee(e){var t=e.day,n=e.onSelect;if(!t)return c.a.createElement("td",{className:"null"});var a=[],r=Object(L.a)();t<r&&a.push("disabled"),[6,0].includes(new Date(t).getDay())&&a.push("weekend");var i=r===t?"\u4eca\u5929":new Date(t).getDate();return c.a.createElement("td",{className:W()(a),onClick:function(){return n(t)}},i)}function te(e){var t=e.days,n=e.onSelect;return c.a.createElement("tr",{className:"date-table-days"},t.map((function(e,t){return c.a.createElement(ee,{key:t,day:e,onSelect:n})})))}function ne(e){for(var t=e.startingTimeInMonth,n=e.onSelect,a=new Date(t),r=new Date(t),i=[];r.getMonth()===a.getMonth();)i.push(r.getTime()),r.setDate(r.getDate()+1);i=new Array(a.getDay()?a.getDay()-1:6).fill(null).concat(i);var o=new Date(i[i.length-1]);i=i.concat(new Array(o.getDay()?7-o.getDay():0).fill(null));for(var l=[],s=0;s<i.length/7;++s){var u=i.slice(7*s,7*(s+1));l.push(u)}return c.a.createElement("table",{className:"date-table"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("td",{colSpan:"7"},c.a.createElement("h5",null,a.getFullYear(),"\u5e74",a.getMonth()+1,"\u6708")))),c.a.createElement("tbody",null,c.a.createElement("tr",{className:"date-table-weeks"},c.a.createElement("th",null,"\u5468\u4e00"),c.a.createElement("th",null,"\u5468\u4e8c"),c.a.createElement("th",null,"\u5468\u4e09"),c.a.createElement("th",null,"\u5468\u56db"),c.a.createElement("th",null,"\u5468\u4e94"),c.a.createElement("th",{className:"weekend"},"\u5468\u516d"),c.a.createElement("th",{className:"weekend"},"\u5468\u65e5")),l.map((function(e,t){return c.a.createElement(te,{key:t,days:e,onSelect:n})}))))}function ae(e){var t=e.show,n=e.onSelect,a=e.onBack,r=new Date;r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0),r.setDate(1);var i=[r.getTime()];return r.setMonth(r.getMonth()+1),i.push(r.getTime()),r.setMonth(r.getMonth()+1),i.push(r.getTime()),c.a.createElement("div",{className:W()("date-selector",{hidden:!t})},c.a.createElement(A.a,{title:"\u65e5\u671f\u9009\u62e9",onBack:a}),c.a.createElement("div",{className:"date-selector-tables"},i.map((function(e){return c.a.createElement(ne,{key:e,startingTimeInMonth:e,onSelect:n})}))))}var ce=Object(o.b)((function(e){return e}),(function(e){return{dispatch:e}}))((function(e){var t=e.from,n=e.to,r=e.dispatch,i=e.cityData,o=e.isLoadingCityData,s=e.isCitySelectorVisible,u=e.isDateSelectorVisible,m=e.departDate,d=e.highSpeed,h=Object(a.useCallback)((function(){window.history.back()}),[]),f=Object(a.useMemo)((function(){return Object(l.b)({exchangeFromTo:D,showCitySelector:k,hideCitySelector:j},r)}),[r]),y=Object(a.useMemo)((function(){return Object(l.b)({onBack:j,fetchCityData:T,onSelect:N},r)}),[r]),p=Object(a.useMemo)((function(){return Object(l.b)({onClick:O},r)}),[r]),g=Object(a.useMemo)((function(){return Object(l.b)({onBack:C},r)}),[r]),E=Object(a.useMemo)((function(){return Object(l.b)({toggle:S},r)}),[r]),b=Object(a.useCallback)((function(e){e&&(e<L.a||(r(function(e){return{type:v,payload:e}}(e)),r(C())))}),[r]);return c.a.createElement("div",null,c.a.createElement("div",{className:"header-wrapper"},c.a.createElement(A.a,{title:"\u706b\u8f66\u7968",onBack:h})),c.a.createElement("form",{className:"form",action:"./query.html"},c.a.createElement(H,Object.assign({from:t,to:n},f)),c.a.createElement(R,Object.assign({time:m},p)),c.a.createElement(Y,Object.assign({highSpeed:d},E)),c.a.createElement(J,null)),c.a.createElement(Z,Object.assign({show:s,cityData:i,isLoading:o},y)),c.a.createElement(ae,Object.assign({show:u},g,{onSelect:b})))})),re=n(9);i.a.render(c.a.createElement(o.a,{store:I},c.a.createElement(ce,null)),document.getElementById("root")),re.a()},9:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function c(e){if("serviceWorker"in navigator){if(new URL("/train_ticket/build",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/train_ticket/build","/service-worker.js");a?(!function(e,t){fetch(e).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):r(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):r(t,e)}))}}function r(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}}},[[33,5,0]]]);
//# sourceMappingURL=index.27e33779.chunk.js.map